<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://likfe.com</id>
    <title>Cafeting • Posts by &#34;linux&#34; tag</title>
    <link href="https://likfe.com" />
    <updated>2023-11-21T06:05:47.000Z</updated>
    <category term="Android" />
    <category term="Flurry" />
    <category term="Confluence" />
    <category term="反编译" />
    <category term="ReactNative" />
    <category term="AccessibilityNodeInfo" />
    <category term="StackOverflow" />
    <category term="Proxy" />
    <category term="AndroidStudio" />
    <category term="Translucent" />
    <category term="SwipeBack" />
    <category term="PopWindow" />
    <category term="AMH" />
    <category term="Flarum" />
    <category term="PHP" />
    <category term="Composer" />
    <category term="ViewPager" />
    <category term="ADB" />
    <category term="Clipboard" />
    <category term="framework" />
    <category term="gradle" />
    <category term="DialogFragment" />
    <category term="PopupWindow" />
    <category term="Google" />
    <category term="Glide" />
    <category term="Intent" />
    <category term="RecyclerView" />
    <category term="Lambda" />
    <category term="Leancloud" />
    <category term="Gradle" />
    <category term="Messenger" />
    <category term="Make" />
    <category term="Mac" />
    <category term="Linux" />
    <category term="JDK" />
    <category term="Fragment" />
    <category term="View" />
    <category term="Scrollbar" />
    <category term="备案" />
    <category term="域名" />
    <category term="Github" />
    <category term="GreenDao" />
    <category term="Rust" />
    <category term="IDEA" />
    <category term="GooglePlay" />
    <category term="Docker" />
    <category term="Jenkins" />
    <category term="MAMP" />
    <category term="树莓派" />
    <category term="Sublime Text" />
    <category term="Emmet" />
    <category term="ThinkPHP" />
    <category term="GitBook" />
    <category term="OSX" />
    <entry>
        <id>https://likfe.com/2023/11/21/cmdlineToolsWithJdk/</id>
        <title>一文了解：Android cmdline-tools 版本与其最小JDK关系</title>
        <link rel="alternate" href="https://likfe.com/2023/11/21/cmdlineToolsWithJdk/"/>
        <content type="html">&lt;p&gt;关键词：Android cmdline-tools 历史版本、Android cmdline-tools 最小JDK版本、JDK 对应 major version、JDK LTS 信息&lt;/p&gt;
&lt;p&gt;由于 JDK8 是一个常用的、较低的版本，因此只需关注 JDK8 及以上版本的运行情况。&lt;/p&gt;
&lt;h2 id=&#34;cmdline-tools-版本和最低-JDK&#34;&gt;&lt;a href=&#34;#cmdline-tools-版本和最低-JDK&#34; class=&#34;headerlink&#34; title=&#34;cmdline-tools 版本和最低 JDK&#34;&gt;&lt;/a&gt;cmdline-tools 版本和最低 JDK&lt;/h2&gt;&lt;p&gt;最终结论：（在 Mac 上，基于 JDK8 测试的结果）&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;cmdline-tools 版本&lt;/th&gt;
&lt;th&gt;最低 JDK&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;16.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.0&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9.0&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8.0&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7.0&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6.0&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;Android 官网的 cmdline-tools 提供的最新版本是16.0（截止2024年09月05日），也就是说，其 Runtime 的 JDK 版本必须是 JDK17 及以上。&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h3 id=&#34;检查流程&#34;&gt;&lt;a href=&#34;#检查流程&#34; class=&#34;headerlink&#34; title=&#34;检查流程&#34;&gt;&lt;/a&gt;检查流程&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;cmdline-tools 版本&lt;/th&gt;
&lt;th&gt;SdkManagerCliSettings&lt;/th&gt;
&lt;th&gt;AndroidLocationsProvider&lt;/th&gt;
&lt;th&gt;最低 JDK&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;13.0&lt;/td&gt;
&lt;td&gt;61 (JDK 17)&lt;/td&gt;
&lt;td&gt;55 (JDK 11)&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12.0&lt;/td&gt;
&lt;td&gt;61 (JDK 17)&lt;/td&gt;
&lt;td&gt;55 (JDK 11)&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11.0&lt;/td&gt;
&lt;td&gt;61 (JDK 17)&lt;/td&gt;
&lt;td&gt;55 (JDK 11)&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.0&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;55 (JDK 11)&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9.0&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;55 (JDK 11)&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8.0&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;7.0&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;6.0&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;52 (JDK 8)&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;通过上表可以看出，在 cmdline-tools 内部，各个 Jar 的编译目标 JDK 版本存在不一致的情况。因此，在实际运行时，需要将所有 Jar 文件的编译目标 JDK 版本的最大值作为 cmdline-tools 运行时的最小的 JDK 版本。&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;$ java -version&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;java version &lt;span class=&#34;string&#34;&gt;&amp;quot;1.8.0_351&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ &lt;span class=&#34;built_in&#34;&gt;cd&lt;/span&gt; path/cmdline-tools/9.0/bin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;$ ./sdkmanager --list&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Error: A JNI error has occurred, please check your installation and try again&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Exception &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; thread &lt;span class=&#34;string&#34;&gt;&amp;quot;main&amp;quot;&lt;/span&gt; java.lang.UnsupportedClassVersionError: com/android/prefs/AndroidLocationsProvider has been compiled by a more recent version of the Java Runtime (class file version 55.0), this version of the Java Runtime only recognizes class file versions up to 52.0&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;由上述报错信息可知，&lt;code&gt;com/android/prefs/AndroidLocationsProvider&lt;/code&gt; 要求最低使用 version 55.0（JDK 11）。&lt;/p&gt;
&lt;p&gt;但是其他 class （比如 &lt;code&gt;lib/sdklib/libsdkmanager_lib.jar&lt;/code&gt; 内的 &lt;code&gt;com.android.sdklib.tool.sdkmanager.SdkManagerCliSettings&lt;/code&gt;）仍旧是 version 52.0 （JDK 8）。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;这里的思路是：&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;直接切换到cmdline-tools对应版本，然后基于 runtime JDK &amp;#x3D; 8 的环境，执行 &lt;code&gt;./sdkmanager --version&lt;/code&gt; 检查是否报错，如报错，查看要求的最低 version 为多少。（低于JDK8的不再验证）&lt;/p&gt;
&lt;p&gt;验证的脚本：&lt;code&gt;majorVersion.sh&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;使用方法：.&amp;#x2F;majorVersion.sh path&amp;#x2F;cmdline-tools&amp;#x2F;11.0&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;#!/bin/bash&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$1&lt;/span&gt;/bin/sdkmanager --version&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;variable&#34;&gt;$1&lt;/span&gt;/bin/sdkmanager --version 2&amp;gt;&amp;amp;1 | grep &lt;span class=&#34;string&#34;&gt;&amp;quot;class file&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;jar_file=/lib/sdklib/libsdkmanager_lib.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;-&amp;gt; &lt;span class=&#34;variable&#34;&gt;$jar_file&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 使用 javap 命令解析 JAR 文件内指定的 class&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;output=$(javap -verbose -classpath &lt;span class=&#34;string&#34;&gt;&amp;quot;$1&lt;span class=&#34;variable&#34;&gt;$&amp;#123;jar_file&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt; com.android.sdklib.tool.sdkmanager.SdkManagerCliSettings 2&amp;gt;&amp;amp;1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#echo &amp;quot;$output&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 查找主要版本号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major_version=$(&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&lt;span class=&#34;variable&#34;&gt;$output&lt;/span&gt;&amp;quot;&lt;/span&gt; | grep  &lt;span class=&#34;string&#34;&gt;&amp;#x27;major version&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 打印主要版本号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;--&amp;gt; &lt;span class=&#34;variable&#34;&gt;$major_version&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;##---&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;jar_file=/lib/common/tools.common.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;-&amp;gt; &lt;span class=&#34;variable&#34;&gt;$jar_file&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 使用 javap 命令解析 JAR 文件内指定的 class&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;output=$(javap -verbose -classpath &lt;span class=&#34;string&#34;&gt;&amp;quot;$1&lt;span class=&#34;variable&#34;&gt;$&amp;#123;jar_file&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt; com.android.prefs.AndroidLocationsProvider 2&amp;gt;&amp;amp;1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 查找主要版本号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major_version=$(&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&lt;span class=&#34;variable&#34;&gt;$output&lt;/span&gt;&amp;quot;&lt;/span&gt; | grep  &lt;span class=&#34;string&#34;&gt;&amp;#x27;major version&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# # 打印主要版本号&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;echo&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;--&amp;gt; &lt;span class=&#34;variable&#34;&gt;$major_version&lt;/span&gt;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;验证结果：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 11.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Exception &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; thread &lt;span class=&#34;string&#34;&gt;&amp;quot;main&amp;quot;&lt;/span&gt; java.lang.UnsupportedClassVersionError: com/android/sdklib/tool/sdkmanager/SdkManagerCli has been compiled by a more recent version of the Java Runtime (class file version 61.0), this version of the Java Runtime only recognizes class file versions up to 52.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/sdklib/libsdkmanager_lib.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/common/tools.common.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 10.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Exception &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; thread &lt;span class=&#34;string&#34;&gt;&amp;quot;main&amp;quot;&lt;/span&gt; java.lang.UnsupportedClassVersionError: com/android/prefs/AndroidLocationsProvider has been compiled by a more recent version of the Java Runtime (class file version 55.0), this version of the Java Runtime only recognizes class file versions up to 52.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/sdklib/libsdkmanager_lib.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/common/tools.common.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 9.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Exception &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; thread &lt;span class=&#34;string&#34;&gt;&amp;quot;main&amp;quot;&lt;/span&gt; java.lang.UnsupportedClassVersionError: com/android/prefs/AndroidLocationsProvider has been compiled by a more recent version of the Java Runtime (class file version 55.0), this version of the Java Runtime only recognizes class file versions up to 52.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/sdklib/libsdkmanager_lib.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/common/tools.common.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 8.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/sdklib/libsdkmanager_lib.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;-&amp;gt; /lib/common/tools.common.jar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;major version: 52&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;h2 id=&#34;扩展资料&#34;&gt;&lt;a href=&#34;#扩展资料&#34; class=&#34;headerlink&#34; title=&#34;扩展资料&#34;&gt;&lt;/a&gt;扩展资料&lt;/h2&gt;&lt;h3 id=&#34;cmdline-tools-历史版本下载&#34;&gt;&lt;a href=&#34;#cmdline-tools-历史版本下载&#34; class=&#34;headerlink&#34; title=&#34;cmdline-tools 历史版本下载&#34;&gt;&lt;/a&gt;cmdline-tools 历史版本下载&lt;/h3&gt;&lt;p&gt;官网地址：&lt;a href=&#34;https://developer.android.com/studio&#34;&gt;https://developer.android.com/studio&lt;/a&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;cmdline-tools 版本&lt;/th&gt;
&lt;th&gt;最低 JDK&lt;/th&gt;
&lt;th&gt;Mac&lt;/th&gt;
&lt;th&gt;Linux&lt;/th&gt;
&lt;th&gt;Windows&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;&lt;tr&gt;
&lt;td&gt;16.0(latest)&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-mac-12266719_latest.zip&#34;&gt;commandlinetools-mac-12266719_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-linux-12266719_latest.zip&#34;&gt;commandlinetools-linux-12266719_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-win-12266719_latest.zip&#34;&gt;commandlinetools-win-12266719_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;13.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-mac-11479570_latest.zip&#34;&gt;commandlinetools-mac-11479570_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-linux-11479570_latest.zip&#34;&gt;commandlinetools-linux-11479570_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-win-11479570_latest.zip&#34;&gt;commandlinetools-win-11479570_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;12.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;commandlinetools-mac-11076708_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-linux-11076708_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-win-11076708_latest.zip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;11.0&lt;/td&gt;
&lt;td&gt;17&lt;/td&gt;
&lt;td&gt;commandlinetools-mac-10406996_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-linux-10406996_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-win-10406996_latest.zip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;10.0&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-mac-9862592_latest.zip&#34;&gt;commandlinetools-mac-9862592_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-linux-9862592_latest.zip&#34;&gt;commandlinetools-linux-9862592_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://dl.google.com/android/repository/commandlinetools-win-9862592_latest.zip&#34;&gt;commandlinetools-win-9862592_latest.zip&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;9.0&lt;/td&gt;
&lt;td&gt;11&lt;/td&gt;
&lt;td&gt;commandlinetools-mac-9477386_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-linux-9477386_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-win-9477386_latest.zip&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;8.0&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;td&gt;commandlinetools-mac-9123335_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-linux-9123335_latest.zip&lt;/td&gt;
&lt;td&gt;commandlinetools-win-9123335_latest.zip&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;p&gt;下载地址的生成规则：&lt;code&gt;https://dl.google.com/android/repository/文件名&lt;/code&gt;&lt;/p&gt;
&lt;h3 id=&#34;JDK-对应-major-version&#34;&gt;&lt;a href=&#34;#JDK-对应-major-version&#34; class=&#34;headerlink&#34; title=&#34;JDK 对应 major version&#34;&gt;&lt;/a&gt;JDK 对应 major version&lt;/h3&gt;&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Java SE 21 = 65 (0x41 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 20 = 64 (0x40 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 19 = 63 (0x3F hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 18 = 62 (0x3E hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(LTS) Java SE 17 = 61 (0x3D hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 16 = 60 (0x3C hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 15 = 59 (0x3B hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 14 = 58 (0x3A hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 13 = 57 (0x39 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 12 = 56 (0x38 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(LTS) Java SE 11 = 55 (0x37 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 10 = 54 (0x36 hex),[4]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 9 = 53 (0x35 hex),[5]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;(LTS) Java SE 8 = 52 (0x34 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 7 = 51 (0x33 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 6.0 = 50 (0x32 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Java SE 5.0 = 49 (0x31 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;JDK 1.4 = 48 (0x30 hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;JDK 1.3 = 47 (0x2F hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;JDK 1.2 = 46 (0x2E hex),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;JDK 1.1 = 45 (0x2D hex).&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;资料来源：&lt;a href=&#34;https://en.wikipedia.org/wiki/Java_class_file#General_layout&#34;&gt;Java class file&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;JDK-LTS-信息&#34;&gt;&lt;a href=&#34;#JDK-LTS-信息&#34; class=&#34;headerlink&#34; title=&#34;JDK LTS 信息&#34;&gt;&lt;/a&gt;JDK LTS 信息&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;JDK 17(LTS)&lt;ul&gt;
&lt;li&gt;major version &amp;#x3D; 61&lt;/li&gt;
&lt;li&gt;积极支持：2026年9月30日&lt;/li&gt;
&lt;li&gt;安全支持：2029年9月30日&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;JDK 11(LTS)&lt;ul&gt;
&lt;li&gt;major version &amp;#x3D; 55&lt;/li&gt;
&lt;li&gt;积极支持：2023年9月30日&lt;/li&gt;
&lt;li&gt;安全支持：2026年9月30日&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;JDK 8(LTS)&lt;ul&gt;
&lt;li&gt;major version &amp;#x3D; 52&lt;/li&gt;
&lt;li&gt;积极支持：2022年3月31日&lt;/li&gt;
&lt;li&gt;安全支持：2030年12月31日&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;资料来源：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://endoflife.date/java&#34;&gt;https://endoflife.date/java&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.oracle.com/java/technologies/java-se-glance.html&#34;&gt;https://www.oracle.com/java/technologies/java-se-glance.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;如果有什么建议或者问题可以随时联系我，共同探讨学习：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Github： &lt;a href=&#34;https://github.com/likfe&#34;&gt;likfe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CSDN：&lt;a href=&#34;https://micro.blog.csdn.net/&#34;&gt;他叫自己Mr.张&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;掘金：&lt;a href=&#34;https://juejin.im/user/56042f4b60b2f3a91f58461d&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;微博：&lt;a href=&#34;http://weibo.com/zyansen&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
        <category term="Android" />
        <category term="Mac" />
        <category term="Linux" />
        <category term="JDK" />
        <updated>2023-11-21T06:05:47.000Z</updated>
    </entry>
    <entry>
        <id>https://likfe.com/2022/10/20/ubuntu-change-sources/</id>
        <title>Ubuntu 换源后仍然报错：404、没有 Release 文件</title>
        <link rel="alternate" href="https://likfe.com/2022/10/20/ubuntu-change-sources/"/>
        <content type="html">&lt;p&gt;关键词：Ubuntu 21.10、换源、404  Not Found、没有 Release 文件&lt;/p&gt;
&lt;p&gt;Ubuntu 执行 &lt;code&gt;apt-get&lt;/code&gt; 命令后会报错，如果简单得更换为国内的源地址也无法解决，那可能和 Ubuntu 的系统版本有关，需要根据具体情况处理。&lt;/p&gt;
&lt;h2 id=&#34;问题&#34;&gt;&lt;a href=&#34;#问题&#34; class=&#34;headerlink&#34; title=&#34;问题&#34;&gt;&lt;/a&gt;问题&lt;/h2&gt;&lt;p&gt;Ubuntu 21.10 执行 &lt;code&gt;apt-get update&lt;/code&gt; 后会报错：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;xx Release 404  Not Found [IP: xxx]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;E: 仓库 &lt;span class=&#34;string&#34;&gt;&amp;quot;xx Release&amp;quot;&lt;/span&gt; 没有 Release 文件。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N: 无法安全地用该源进行更新，所以默认禁用该源。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N: 参见 apt-secure(8) 手册以了解仓库创建和用户配置方面的细节。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;尝试更换源（&lt;code&gt;/etc/apt/sources.list&lt;/code&gt;）之后，还是一样的错误。&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;ul&gt;
&lt;li&gt;阿里云镜像：&lt;a href=&#34;https://developer.aliyun.com/mirror/ubuntu&#34;&gt;https://developer.aliyun.com/mirror/ubuntu&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;清华大学开源软件镜像站：&lt;a href=&#34;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/&#34;&gt;https://mirrors.tuna.tsinghua.edu.cn/help/ubuntu/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由于使用的是 Ubuntu 21.10，在查询 &lt;a href=&#34;https://ubuntu.com/about/release-cycle&#34;&gt;Ubuntu 生命周期和发布节奏&lt;/a&gt; 后发现，Ubuntu 21.10 生命周期截止到 2022.07。（还有 Ubuntu 21.04，生命周期截止时间是 2022.01）&lt;/p&gt;
&lt;p&gt;当前是 2022.10，已经超出生命结束周期（EOL）时间了。&lt;/p&gt;
&lt;h2 id=&#34;解决方案&#34;&gt;&lt;a href=&#34;#解决方案&#34; class=&#34;headerlink&#34; title=&#34;解决方案&#34;&gt;&lt;/a&gt;解决方案&lt;/h2&gt;&lt;p&gt;对于超出 EOL 的版本，有两种解决方案可以让 &lt;code&gt;apt-get&lt;/code&gt; 恢复正常：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;升级 Ubuntu 版本&lt;/li&gt;
&lt;li&gt;将源 url 更换到旧的包存储库（old-releases）&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;说明：示例的命令是非 root 用户，如果是 root 用户，则不需要输命令前面的 &lt;code&gt;sudo&lt;/code&gt;。例如&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非 root 用户：&lt;code&gt;sudo apt-get update&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;则 root 用户时：&lt;code&gt;apt-get update&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;详细方案如下：&lt;/p&gt;
&lt;h3 id=&#34;1-升级系统版本&#34;&gt;&lt;a href=&#34;#1-升级系统版本&#34; class=&#34;headerlink&#34; title=&#34;1. 升级系统版本&#34;&gt;&lt;/a&gt;1. 升级系统版本&lt;/h3&gt;&lt;p&gt;最简单的方法是将 Ubuntu 系统升级到最新版本：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo apt-get dist-upgrade&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;这个方法风险比较大，尤其是我们当前的版本与最终要升级到的版本差的版本比较大的时候；另外，经过测试，升级系统的过程，会卸载重装一些软件，而软件重装后，软件安装过的三方包会丢失，需要重新安装。&lt;/p&gt;
&lt;p&gt;例如 Python，升级完系统后，需要再次使用 pip 安装之前使用到的 package。&lt;/p&gt;
&lt;p&gt;如果升级系统版本的方式暂时无法评估风险，可以考虑更换 sources url（Packages Url）的方式。&lt;/p&gt;
&lt;p&gt;注意：如果遇到直接升级系统失败的情况，需要先使用方案2，更新好本地的源地址等信息之后，才能正常完成系统升级。&lt;/p&gt;
&lt;h3 id=&#34;2-更换为-old-releases-的源地址&#34;&gt;&lt;a href=&#34;#2-更换为-old-releases-的源地址&#34; class=&#34;headerlink&#34; title=&#34;2. 更换为 old-releases 的源地址&#34;&gt;&lt;/a&gt;2. 更换为 old-releases 的源地址&lt;/h3&gt;&lt;p&gt;Ubuntu 超出 EOL 的版本的源地址是 &lt;a href=&#34;http://old-releases.ubuntu.com./&#34;&gt;http://old-releases.ubuntu.com。&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;非 arm 架构的机器：需要用 &lt;code&gt;old-releases.ubuntu.com&lt;/code&gt; 的地址替换掉所有的 &lt;code&gt;archive.ubuntu.com&lt;/code&gt; 和 &lt;code&gt;security.ubuntu.com&lt;/code&gt; 地址。&lt;/li&gt;
&lt;li&gt;arm 架构的机器：需要用 &lt;code&gt;old-releases.ubuntu.com/ubuntu&lt;/code&gt; 的地址替换掉所有的 &lt;code&gt;ports.ubuntu.com/ubuntu-ports&lt;/code&gt; 地址。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;先确认下源的配置情况：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; /etc/apt/sources.list&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;情况一：使用的是 &lt;code&gt;archive.ubuntu.com&lt;/code&gt; 和 &lt;code&gt;security.ubuntu.com&lt;/code&gt; 地址：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 使用 sed 命令，用 old-releases.ubuntu.com 替换掉所有的 archive.ubuntu.com 和 security.ubuntu.com&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo sed -i -e &lt;span class=&#34;string&#34;&gt;&amp;#x27;s/archive.ubuntu.com\|security.ubuntu.com/old-releases.ubuntu.com/g&amp;#x27;&lt;/span&gt; /etc/apt/sources.list&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 再次检查是否已经全部替换&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; /etc/apt/sources.list&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 更新和同步源信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;情况二：使用的是 &lt;code&gt;ports.ubuntu.com&lt;/code&gt; 地址：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 使用 sed 命令，用 old-releases.ubuntu.com/ubuntu 替换掉所有的 ports.ubuntu.com/ubuntu-ports&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo sed -i -e &lt;span class=&#34;string&#34;&gt;&amp;#x27;s/ports.ubuntu.com\/ubuntu-ports/old-releases.ubuntu.com\/ubuntu/g&amp;#x27;&lt;/span&gt; /etc/apt/sources.list&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 再次检查是否已经全部替换&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;cat&lt;/span&gt; /etc/apt/sources.list&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 更新和同步源信息&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sudo apt-get update&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;现在，就能够在不受支持的旧 Ubuntu 版本上安装或更新软件包了。&lt;/p&gt;
&lt;p&gt;注意：如果使用了国内的源地址，可以参考上述 2 个情况，对域名或者路径进行替换。&lt;/p&gt;
&lt;h2 id=&#34;总结&#34;&gt;&lt;a href=&#34;#总结&#34; class=&#34;headerlink&#34; title=&#34;总结&#34;&gt;&lt;/a&gt;总结&lt;/h2&gt;&lt;p&gt;网上很多文章，解决这类问题的时候，通常是换一个阿里云或者清华大学开源软件镜像地址，无法切实解决问题。&lt;/p&gt;
&lt;p&gt;同样是换源地址，我们在了解到 Ubuntu 系统有 EOL 时间这一信息后，才能根据实际情况做出正确的修改。&lt;/p&gt;
&lt;p&gt;如果有什么建议或者问题可以随时联系我，共同探讨学习：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Github： &lt;a href=&#34;https://github.com/likfe&#34;&gt;likfe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CSDN：&lt;a href=&#34;https://micro.blog.csdn.net/&#34;&gt;他叫自己Mr.张&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;掘金：&lt;a href=&#34;https://juejin.im/user/56042f4b60b2f3a91f58461d&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;微博：&lt;a href=&#34;http://weibo.com/zyansen&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
        <category term="Linux" />
        <updated>2022-10-20T03:29:45.000Z</updated>
    </entry>
    <entry>
        <id>https://likfe.com/2022/10/17/rasP4b-avahi-daemon/</id>
        <title>禁用和卸载树莓派 4B 上 avahi-daemon</title>
        <link rel="alternate" href="https://likfe.com/2022/10/17/rasP4b-avahi-daemon/"/>
        <content type="html">&lt;p&gt;关键词：树莓派、Linux、avahi、avahi-daemon、CPU&lt;/p&gt;
&lt;h2 id=&#34;背景&#34;&gt;&lt;a href=&#34;#背景&#34; class=&#34;headerlink&#34; title=&#34;背景&#34;&gt;&lt;/a&gt;背景&lt;/h2&gt;&lt;p&gt;在树莓派4B上安装了官方的 Ubuntu 系统，运行 &lt;code&gt;top&lt;/code&gt; 指令，发现 &lt;code&gt;avahi-daemon&lt;/code&gt; 占用 CPU 高，且对 CPU 的消耗波动比较大。&lt;/p&gt;
&lt;p&gt;查资料发现：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Avahi 允许程序在不需要进行手动网络配置的情况 下，在一个本地网络中发布和获知各种服务和主机。例如，当某用户把他的计算机接入到某个局域网时，如果他的机器运行有Avahi服务，则Avahi程式自动广播，从而发现网络中可用的打印机、共享文件和可相互聊天的其他用户。这有点象他正在接收局域网中的各种网络广告一样。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;除非你有兼容的设备或使用 zeroconf 协议的服务，否则应该关闭它。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我不需要 &lt;strong&gt;zeroconf&lt;/strong&gt; 的相关功能，遂尝试禁用或者卸载  &lt;code&gt;avahi-daemon&lt;/code&gt;。&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;处理过程&#34;&gt;&lt;a href=&#34;#处理过程&#34; class=&#34;headerlink&#34; title=&#34;处理过程&#34;&gt;&lt;/a&gt;处理过程&lt;/h2&gt;&lt;p&gt;基本环境：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;硬件：树莓派4B&lt;/li&gt;
&lt;li&gt;系统：Ubuntu 21.10 (GNU&amp;#x2F;Linux 5.13.0-1031-raspi aarch64) &lt;/li&gt;
&lt;li&gt;权限：root 用户权限&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;方式一：停止和禁用服务&#34;&gt;&lt;a href=&#34;#方式一：停止和禁用服务&#34; class=&#34;headerlink&#34; title=&#34;方式一：停止和禁用服务&#34;&gt;&lt;/a&gt;方式一：停止和禁用服务&lt;/h3&gt;&lt;p&gt;首先尝试禁用  &lt;code&gt;avahi-daemon&lt;/code&gt; ：（root 权限）&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 尝试停止并禁用 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 查看 avahi-daemon 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 停止 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl stop avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 再次查看 avahi-daemon 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 禁用 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl &lt;span class=&#34;built_in&#34;&gt;disable&lt;/span&gt; avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;执行停止  &lt;code&gt;avahi-daemon&lt;/code&gt;  的时候，返回一个提示：&lt;code&gt;avahi-daemon.socket&lt;/code&gt; 可能会重启 &lt;code&gt;avahi-daemon&lt;/code&gt;。出现这种情况时，说明 &lt;code&gt;avahi-daemon&lt;/code&gt; 是由 &lt;code&gt;avahi-daemon.socket&lt;/code&gt; 启动的，我们单独停止和禁用 &lt;code&gt;avahi-daemon&lt;/code&gt; 是不行的，它还会自动启动。&lt;/p&gt;
&lt;p&gt;需要先停止 &lt;code&gt;avahi-daemon.socket&lt;/code&gt;，再停止 &lt;code&gt;avahi-daemon&lt;/code&gt;：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 停止和禁用 avahi-daemon.socket&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 查看 avahi-daemon.socket 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.socket&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 停止 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl stop avahi-daemon.socket&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 再次查看 avahi-daemon 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.socket&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 禁用 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl &lt;span class=&#34;built_in&#34;&gt;disable&lt;/span&gt; avahi-daemon.socket&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 停止和禁用 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 查看 avahi-daemon 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 停止 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl stop avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 再次查看 avahi-daemon 当前状态&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl status avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## 禁用 avahi-daemon&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;systemctl &lt;span class=&#34;built_in&#34;&gt;disable&lt;/span&gt; avahi-daemon.service&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;由于本人遇到了重启后这2个服务还会自动重启的情况，所以最终通过卸载的方式来解决的。你可以根据自己的实际情况，决定是否使用卸载的方案。&lt;/p&gt;
&lt;h3 id=&#34;方式二：卸载-avahi-daemon-相关的所有服务&#34;&gt;&lt;a href=&#34;#方式二：卸载-avahi-daemon-相关的所有服务&#34; class=&#34;headerlink&#34; title=&#34;方式二：卸载 avahi-daemon 相关的所有服务&#34;&gt;&lt;/a&gt;方式二：卸载 avahi-daemon 相关的所有服务&lt;/h3&gt;&lt;p&gt;由于单纯的卸载 avahi-daemon 可能引起依赖它的软件无法正常运行，此操作需要慎重考虑和检测：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 卸载方式一：卸载并清理配置文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apt-get purge avahi-daemon&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 卸载方式而：卸载并保留配置文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apt-get remove avahi-daemon&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#注意：卸载时可能会提示下列软件包将被【卸载】，即卸载 avahi-daemon 会同时卸载依赖它的软件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 最后，你可以清理下不需要的自动安装的软件：&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;apt autoremove&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;



&lt;p&gt;资料：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://superuser.com/questions/316715/removing-the-avahi-daemon-on-ubuntu&#34;&gt;Removing the avahi-daemon on Ubuntu&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;如果有什么建议或者问题可以随时联系我，共同探讨学习：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Github： &lt;a href=&#34;https://github.com/likfe&#34;&gt;likfe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CSDN：&lt;a href=&#34;https://micro.blog.csdn.net/&#34;&gt;他叫自己Mr.张&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;掘金：&lt;a href=&#34;https://juejin.im/user/56042f4b60b2f3a91f58461d&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;微博：&lt;a href=&#34;http://weibo.com/zyansen&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
        <category term="Linux" />
        <category term="树莓派" />
        <updated>2022-10-17T10:38:52.000Z</updated>
    </entry>
    <entry>
        <id>https://likfe.com/2021/12/19/raspberry-pi-hdmi/</id>
        <title>树莓派配置文件 config.txt - HDMI 热插拔</title>
        <link rel="alternate" href="https://likfe.com/2021/12/19/raspberry-pi-hdmi/"/>
        <content type="html">&lt;p&gt;快速预览：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;config.txt&lt;/code&gt; 的路径通常是 &lt;code&gt;/boot/config.txt&lt;/code&gt;，如果找不到，可能是 &lt;code&gt;/boot/firmware/config.txt&lt;/code&gt;。再找不到，参考文章内【找到 config.txt】的思路去找。&lt;/li&gt;
&lt;li&gt;在 config.txt 里增加如下 2 行内容后重启树莓派即可开启 HDMI 热插拔功能&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hdmi_force_hotplug=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hdmi_drive=2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;0x00：问题和背景&#34;&gt;&lt;a href=&#34;#0x00：问题和背景&#34; class=&#34;headerlink&#34; title=&#34;0x00：问题和背景&#34;&gt;&lt;/a&gt;0x00：问题和背景&lt;/h2&gt;&lt;p&gt;新到的树莓派4B，安装了带桌面的 Ubuntu 系统，前期为了方便，通过 HDMI 线外接了显示器，方便配置系统。但是配置完毕并拔掉显示器之后发现一个问题：重启树莓派后，如果没有外接显示器，则无法正常进入系统，定位到是 HDMI 检测机制的问题，它默认需要插上显示器才能正常启动。&lt;/p&gt;
&lt;p&gt;查到资料需要开启树莓派的 HDMI 热插拔才能不依赖外接显示器。&lt;br&gt;于是需要我们：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;找到配置文件 config.txt （本文重点）&lt;/li&gt;
&lt;li&gt;修改 config.txt&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;0x01：定位-config-txt&#34;&gt;&lt;a href=&#34;#0x01：定位-config-txt&#34; class=&#34;headerlink&#34; title=&#34;0x01：定位 config.txt&#34;&gt;&lt;/a&gt;0x01：定位 config.txt&lt;/h2&gt;&lt;p&gt;修改 config.txt 有2大类方法&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;取出 SD 卡，在其他电脑上进行读取 SD 卡内容，找到 &lt;code&gt;config.txt&lt;/code&gt; 进行修改&lt;/li&gt;
&lt;li&gt;直接在树莓派内部运行中的系统当中进行修改&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;下面说下方法2：&lt;/p&gt;
&lt;p&gt;通常 &lt;code&gt;config.txt&lt;/code&gt; 的路径是 &lt;code&gt;/boot/config.txt&lt;/code&gt;，但是&lt;strong&gt;如果找不到&lt;/strong&gt;，需要查看下磁盘分区，找到&lt;strong&gt;启动分区&lt;/strong&gt;所在的目录。&lt;/p&gt;
&lt;figure class=&#34;highlight shell&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;$ &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;fdisk -l&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Device         Boot  Start       End   Sectors  Size Id Type&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/dev/mmcblk0p1 *      2048    526335    524288  256M  c W95 FAT32 (LBA)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/dev/mmcblk0p2      526336 124735454 124209119 59.2G 83 Linux&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;看到2个分区：&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;- /dev/mmcblk0p1 (启动分区)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;- /dev/mmcblk0p2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta prompt_&#34;&gt;$ &lt;/span&gt;&lt;span class=&#34;language-bash&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;df&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Filesystem     1K-blocks     Used Available Use% Mounted on&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/dev/mmcblk0p1    258095   113997    144099  45% /boot/firmware&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/dev/mmcblk0p2  61862116 11804636  47472868  20% /&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;可见&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;- /dev/mmcblk0p2 挂载到 / 目录下，&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;- /dev/mmcblk0p1 挂载到 /boot/firmware 目录下&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;那么，config.txt 没在 /boot/下，应该就在 /boot/firmware 下了，即 /boot/firmware/config.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;h2 id=&#34;0x02：修改-config-txt&#34;&gt;&lt;a href=&#34;#0x02：修改-config-txt&#34; class=&#34;headerlink&#34; title=&#34;0x02：修改 config.txt&#34;&gt;&lt;/a&gt;0x02：修改 config.txt&lt;/h2&gt;&lt;p&gt;添加如下2行到 &lt;code&gt;config.txt&lt;/code&gt; 然后重启树莓派即可&lt;/p&gt;
&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;hdmi_force_hotplug=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;hdmi_drive=2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;hdmi_force_hotplug=1&lt;/code&gt; 设置树莓派使用 HDMI 热插拔模式，即使没有检测到 HDMI 显示器。 &lt;/li&gt;
&lt;li&gt;&lt;code&gt;hdmi_drive=2&lt;/code&gt; 将树莓派设置为正常的 HDMI 模式（如果支持和启用，将发送声音）。如果没有这条线，树莓派将默认切换到 DVI（无音频）模式。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;参考资料：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://raspberrypi.stackexchange.com/questions/2169/how-do-i-force-the-raspberry-pi-to-turn-on-hdmi&#34;&gt;How do I force the Raspberry Pi to turn on HDMI?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.raspigeek.com/index.php?c=read&amp;id=116&amp;page=1&#34;&gt;树莓派配置文件config.txt 参数详细介绍&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zhuanlan.zhihu.com/p/104282522&#34;&gt;树莓派4系统初始配置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.shellhacks.com/raspberry-pi-force-hdmi-hotplug/&#34;&gt;Raspberry Pi：强制 HDMI 热插拔&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="Linux" />
        <category term="树莓派" />
        <updated>2021-12-19T10:56:39.000Z</updated>
    </entry>

    <follow_challenge>
        <feedId>73986782175755264</feedId>
        <userId>72100854660436992</userId>
    </follow_challenge>
</feed>
