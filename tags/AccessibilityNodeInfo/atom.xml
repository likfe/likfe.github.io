<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://likfe.com</id>
    <title>Cafeting • Posts by &#34;accessibilitynodeinfo&#34; tag</title>
    <link href="https://likfe.com" />
    <updated>2019-02-17T13:06:40.000Z</updated>
    <category term="Android" />
    <category term="Flurry" />
    <category term="Confluence" />
    <category term="反编译" />
    <category term="ReactNative" />
    <category term="AccessibilityNodeInfo" />
    <category term="StackOverflow" />
    <category term="Proxy" />
    <category term="AndroidStudio" />
    <category term="Translucent" />
    <category term="SwipeBack" />
    <category term="PopWindow" />
    <category term="AMH" />
    <category term="Flarum" />
    <category term="PHP" />
    <category term="Composer" />
    <category term="ViewPager" />
    <category term="ADB" />
    <category term="Clipboard" />
    <category term="framework" />
    <category term="gradle" />
    <category term="DialogFragment" />
    <category term="PopupWindow" />
    <category term="Google" />
    <category term="Glide" />
    <category term="Intent" />
    <category term="RecyclerView" />
    <category term="Lambda" />
    <category term="Leancloud" />
    <category term="Gradle" />
    <category term="Messenger" />
    <category term="Make" />
    <category term="Mac" />
    <category term="Linux" />
    <category term="JDK" />
    <category term="Fragment" />
    <category term="View" />
    <category term="Scrollbar" />
    <category term="备案" />
    <category term="域名" />
    <category term="Github" />
    <category term="GreenDao" />
    <category term="Rust" />
    <category term="IDEA" />
    <category term="GooglePlay" />
    <category term="Docker" />
    <category term="Jenkins" />
    <category term="MAMP" />
    <category term="树莓派" />
    <category term="Sublime Text" />
    <category term="Emmet" />
    <category term="ThinkPHP" />
    <category term="GitBook" />
    <category term="OSX" />
    <entry>
        <id>https://likfe.com/2019/02/17/StackOverflowErrorInAccessibilityNodeInfo/</id>
        <title>遍历 AccessibilityNodeInfo 报 StackOverflowError</title>
        <link rel="alternate" href="https://likfe.com/2019/02/17/StackOverflowErrorInAccessibilityNodeInfo/"/>
        <content type="html">&lt;p&gt;在使用 AccessibilityService 遍历包含 WebView 的 AccessibilityNodeInfo 时会在某些情况下必现 &lt;code&gt;StackOverflowError&lt;/code&gt; 的错误，导致应用崩溃。&lt;/p&gt;
&lt;h2 id=&#34;0x00-异常&#34;&gt;&lt;a href=&#34;#0x00-异常&#34; class=&#34;headerlink&#34; title=&#34;0x00 异常&#34;&gt;&lt;/a&gt;0x00 异常&lt;/h2&gt;&lt;p&gt;最近使用 Android 的 AccessibilityService 做一些自动化操作时发现，在部分机器上遍历包含 WebView 页面的 AccessibilityNodeInfo 时，某些页面必定会引起 &lt;code&gt;StackOverflowError&lt;/code&gt; 错误，经过一番查证，定位到主要与系统所使用的 Android System WebView 版本有关，属于 WebView 的 Bug。&lt;/p&gt;
&lt;p&gt;相关说明可以参考 &lt;a href=&#34;https://bugs.chromium.org/p/chromium/issues/detail?id=805014&#34;&gt;Android: Infinite loop of FrameLayouts in accessibility tree&lt;/a&gt; 的讨论。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;查看 Android System WebView 版本&lt;/strong&gt;（以下2种方法任一均可）：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;应用程序&lt;ol&gt;
&lt;li&gt;菜单：显示系统应用程序&lt;/li&gt;
&lt;li&gt;点击列表中的：Android System WebView&lt;/li&gt;
&lt;li&gt;详情页内包含版本&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;开发者选项&lt;ol&gt;
&lt;li&gt;开启「开发者选项」&lt;/li&gt;
&lt;li&gt;开发者选项 -&amp;gt; WebView 实现&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;

&lt;h2 id=&#34;0x01-解决&#34;&gt;&lt;a href=&#34;#0x01-解决&#34; class=&#34;headerlink&#34; title=&#34;0x01 解决&#34;&gt;&lt;/a&gt;0x01 解决&lt;/h2&gt;&lt;p&gt;方法有2种：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;一个是尝试在 Google Play Store 中升级 Android System WebView 到最新版；&lt;/li&gt;
&lt;li&gt;一个是使用递归遍历 AccessibilityNodeInfo 时限制遍历的最大深度，这个深度根据情况大致在 40~70之间即可，既要基本保证能遍历完正常的 NodeTree 内的 Node，又要不引起  &lt;code&gt;StackOverflowError&lt;/code&gt; 导致应用崩溃。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;当然，方法2更具有可控性和兼容性，某些情况下我们并不能左右用户手机上 Android System WebView 的版本。&lt;/p&gt;
&lt;h2 id=&#34;0x02-总结&#34;&gt;&lt;a href=&#34;#0x02-总结&#34; class=&#34;headerlink&#34; title=&#34;0x02 总结&#34;&gt;&lt;/a&gt;0x02 总结&lt;/h2&gt;&lt;p&gt;此类情况发生在特定的 Android System WebView 和 Android 版本上，建议使用了相关功能的应用加上 Bug 上报的功能。&lt;/p&gt;
&lt;p&gt;如果有什么建议或者问题可以随时联系我，共同探讨学习：&lt;/p&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Github： &lt;a href=&#34;http://likfe.github.io/&#34;&gt;likfe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;CSDN：&lt;a href=&#34;http://blog.csdn.net/ys743276112&#34;&gt;他叫自己Mr.张&lt;/a&gt; &lt;/li&gt;
&lt;li&gt;掘金：&lt;a href=&#34;https://juejin.im/user/56042f4b60b2f3a91f58461d&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;微博：&lt;a href=&#34;http://weibo.com/zyansen&#34;&gt;cafeting&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
</content>
        <category term="AccessibilityNodeInfo" />
        <category term="StackOverflow" />
        <updated>2019-02-17T13:06:40.000Z</updated>
    </entry>

    <follow_challenge>
        <feedId>73986782175755264</feedId>
        <userId>72100854660436992</userId>
    </follow_challenge>
</feed>
